/*!
 * ExpressionEngine - by EllisLab
 *
 * @package		ExpressionEngine
 * @author		ExpressionEngine Dev Team
 * @copyright	Copyright (c) 2003 - 2010, EllisLab, Inc.
 * @since		Version 2.0
 * @filesource
 */

$(document).ready(function(){function j(a){$("#crop_x").val(Math.floor(a.x));$("#crop_y").val(Math.floor(a.y));$("#crop_width").val(Math.floor(a.w));$("#crop_height").val(Math.floor(a.h))}function c(a){$(".edit_option").hide();a!==undefined&&$("#"+a+"_fieldset").fadeIn();$("#crop_x").val("");$("#crop_y").val("");$("#crop_width").val("");$("#crop_height").val("");$("#resize_width").val("");$("#resize_height").val("")}function k(a,b,h){var d={};d[EE.lang.no]=function(){$.isFunction(h)&&h.apply();$(this).dialog("close")};
d[EE.lang.apply_changes]=function(){$.isFunction(b)&&b.apply();$(this).dialog("close")};$("#confirm").dialog({buttons:d,open:function(){$(this).find("div").html(a)},modal:true})}function i(a){if(a===undefined){$("#resize_width").val($("#edit_image").width());$("#resize_height").val($("#edit_image").height())}else{e=true;$("#resize_width").val(Math.floor(a.width));$("#resize_height").val(Math.floor(a.height))}}function l(){c("resize");i();$("#edit_image").resizable({handles:"all",animate:true,ghost:true,
aspectRatio:true,knobHandles:true,resize:function(a,b){i(b.size)}})}function f(a,b){if(b===undefined)b=[50,50,100,100];$("#edit_image").resizable("destroy");$("#edit_image_holder").html('<img src="'+EE.filemanager.url_path+'" alt="" id="edit_image" />');if(a==="rotate")c("rotate");else if(a==="resize")setTimeout(l,250);else{c("crop");$("#edit_image").Jcrop({setSelect:b,onChange:j,onSelect:function(){e=true}})}}function g(a){e!==false?k(EE.lang.exit_apply_changes,function(){$("#edit_file_submit").click();
return true},function(){f(a)}):f(a)}$(".edit_option").hide();$("#rotate_fieldset p").hide();$("#rotate_fieldset .icons").show();$("#showToolbarLink a").toggle(function(){$("#file_manager_tools").hide();$("#showToolbarLink a span").text(EE.lang.show_toolbar);$("#showToolbarLink").animate({marginRight:"20"});$("#file_manager_holder").animate({marginRight:"10"});$("#hideToolbarImg").hide();$("#showToolbarImg").css("display","inline")},function(){$("#showToolbarLink a span").text(EE.lang.hide_toolbar);
$("#showToolbarLink").animate({marginRight:"264"});$("#file_manager_holder").animate({marginRight:"250"},function(){$("#file_manager_tools").show();$("#showToolbarImg").hide();$("#hideToolbarImg").css("display","inline")})});$("#file_manager_tools h3 a").toggle(function(){$(this).parent().next("div").slideUp();$(this).toggleClass("closed")},function(){$(this).parent().next("div").slideDown();$(this).toggleClass("closed")});$("#file_manager_list h3").toggle(function(){$(this).next().slideUp();$(this).toggleClass("closed")},
function(){$(this).next().slideDown();$(this).toggleClass("closed")});var e=false,m=$("#edit_image").height()/$("#edit_image").width(),n=$("#edit_image").width()/$("#edit_image").height();$("#rotate_fieldset li img").click(function(){var a=$(this).parent("li").attr("class").substr(7);$("p.last select#rotate").val(a);$("#edit_file_submit").attr("disabled",true).addClass("disabled_field");$("#image_edit_form").submit()},function(){$("#edit_file_submit").attr("disable","false").removeClass("disabled_field")});
$("#crop_mode").click(function(){g("crop");return false});$("#resize_mode").click(function(){g("resize");return false});$(".crop_dim").keyup(function(){f("crop",[$("#crop_x").val(),$("#crop_y").val(),parseInt($("#crop_x").val())+parseInt($("#crop_width").val()),parseInt($("#crop_y").val())+parseInt($("#crop_height").val())])});$("#resize_width").keyup(function(){var a=parseInt($("#resize_width").val()),b=Math.floor(m*a);$("#edit_image, .ui-wrapper").width(a);$("#edit_image, .ui-wrapper").height(b);
$("#resize_height").val(b)});$("#resize_height").keyup(function(){var a=parseInt($("#resize_height").val()),b=Math.floor(n*a);$("#edit_image, .ui-wrapper").width(b);$("#edit_image, .ui-wrapper").height(a);$("#resize_width").val(b)});$("#rotate_mode").click(function(){g("rotate");return false});$("#rotate").change(function(){})});
