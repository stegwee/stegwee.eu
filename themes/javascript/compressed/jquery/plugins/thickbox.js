/*!
 * Thickbox 3.1 - One Box To Rule Them All.
 * By Cody Lindley (http://www.codylindley.com)
 * Copyright (c) 2007 cody lindley
 * Licensed under the MIT License: http://www.opensource.org/licenses/mit-license.php
 *
 * Modifications made to allow for declaration of windows in percentage terms
 * Most of the credit for this belongs to Dave Miller (Dave-Miller.com) - thanks Dave!
 */

var tb_pathToImage=EE.PATH_CP_GBL_IMG+"loadingAnimation.gif",TB_ajaxCache=[],TB_WIDTH=0,TB_HEIGHT=0,TB_WIDTH_PARAM=0,TB_HEIGHT_PARAM=0,TB_PAGESIZE=Array(0,0),TB_SCROLL=Array(0,0),TB_HTML_OVERFLOW="auto",TB_BODY_OVERFLOW="auto",TB_MARGIN_LEFT=0,TB_MARGIN_TOP=0;$(document).ready(function(){tb_init("a.thickbox, area.thickbox, input.thickbox");imgLoader=new Image;imgLoader.src=tb_pathToImage});
function tb_init(a){$(a).click(function(){tb_show(this.title||this.name||null,this.href||this.alt,this.rel||false);this.blur();return false})}
function tb_show(a,b,c){try{if(typeof document.body.style.maxHeight==="undefined"){$("body","html").css({height:"100%",width:"100%"});$("html").css("overflow","hidden");if(document.getElementById("TB_HideSelect")===null){$("body").append("<iframe id='TB_HideSelect'></iframe><div id='TB_overlay'></div><div id='TB_window'></div>");$("#TB_overlay").fadeIn("slow");$("#TB_overlay").click(tb_remove)}}else if(document.getElementById("TB_overlay")===null){$("body").fadeIn("slow");$("body").append("<div id='TB_overlay'></div><div id='TB_window'></div>");
$("#TB_overlay").fadeIn("slow").click(tb_remove)}tb_detectMacXFF()?$("#TB_overlay").addClass("TB_overlayMacFFBGHack"):$("#TB_overlay").addClass("TB_overlayBG");if(a===null)a="";$("body").append("<div id='TB_load'><img src='"+imgLoader.src+"' /></div>");$("#TB_load").show("1000");var e=/\.jpg$|\.jpeg$|\.png$|\.gif$|\.bmp$/,h=(b.indexOf("?")!==-1?b.substr(0,b.indexOf("?")):b).toLowerCase().match(e);if(h==".jpg"||h==".jpeg"||h==".png"||h==".gif"||h==".bmp"){TB_imageCount=TB_NextHTML=TB_NextURL=TB_NextCaption=
TB_PrevHTML=TB_PrevURL=TB_PrevCaption="";TB_FoundURL=false;if(c){TB_TempArray=$("a[rel="+c+"]").get();for(TB_Counter=0;TB_Counter<TB_TempArray.length&&TB_NextHTML==="";TB_Counter++){TB_TempArray[TB_Counter].href.toLowerCase().match(e);if(TB_TempArray[TB_Counter].href!=b)if(TB_FoundURL){TB_NextCaption=TB_TempArray[TB_Counter].title;TB_NextURL=TB_TempArray[TB_Counter].href;TB_NextHTML="<span id='TB_next'>&nbsp;&nbsp;<a href='#'>Next &gt;</a></span>"}else{TB_PrevCaption=TB_TempArray[TB_Counter].title;
TB_PrevURL=TB_TempArray[TB_Counter].href;TB_PrevHTML="<span id='TB_prev'>&nbsp;&nbsp;<a href='#'>&lt; Prev</a></span>"}else{TB_FoundURL=true;TB_imageCount="Image "+(TB_Counter+1)+" of "+TB_TempArray.length}}}imgPreloader=new Image;imgPreloader.onload=function(){imgPreloader.onload=null;var d=tb_getPageSize(),i=d[0]-150;d=d[1]-150;var f=imgPreloader.width,g=imgPreloader.height;if(f>i){g*=i/f;f=i;if(g>d){f*=d/g;g=d}}else if(g>d){f*=d/g;g=d;if(f>i){g*=i/f;f=i}}TB_WIDTH=f+30;TB_HEIGHT=g+60;TB_WIDTH_PARAM=
TB_WIDTH;TB_HEIGHT_PARAM=TB_HEIGHT;$("#TB_window").fadeIn("slow");$("#TB_window").append("<a href='' id='TB_ImageOff' title='Close'><img id='TB_Image' src='"+b+"' width='"+f+"' height='"+g+"' alt='"+a+"'/></a><div id='TB_caption'>"+a+"<div id='TB_secondLine'>"+TB_imageCount+TB_PrevHTML+TB_NextHTML+"</div></div><div id='TB_closeWindow'><a href='#' id='TB_closeWindowButton' title='Close'>close</a> or Esc Key</div>");$(".TB_closeWindowButton").click(tb_remove);if(TB_PrevHTML!==""){var k=function(){$(document).unbind("click",
k)&&$(document).unbind("click",k);$("#TB_window").remove();$("body").append("<div id='TB_window'></div>");tb_show(TB_PrevCaption,TB_PrevURL,c);return false};$("#TB_prev").click(k)}if(TB_NextHTML!==""){var l=function(){$("#TB_window").remove();$("body").append("<div id='TB_window'></div>");tb_show(TB_NextCaption,TB_NextURL,c);return false};$("#TB_next").click(l)}document.onkeydown=function(m){keycode=m==null?event.keyCode:m.which;if(keycode==27)tb_remove();else if(keycode==190){if(TB_NextHTML!=""){document.onkeydown=
"";l()}}else if(keycode==188)if(TB_PrevHTML!=""){document.onkeydown="";k()}};tb_position();$("#TB_load").remove();$("#TB_ImageOff").click(tb_remove);$("#TB_window").css({display:"block"})};imgPreloader.src=b}else{var o=b.replace(/^[^\?]+\??/,""),j=tb_parseQuery(o);TB_WIDTH_PARAM=j.width;TB_HEIGHT_PARAM=j.height;TB_WIDTH=tb_calculateSize(TB_WIDTH_PARAM,0);TB_HEIGHT=tb_calculateSize(TB_HEIGHT_PARAM,1);ajaxContentW=TB_WIDTH-30;ajaxContentH=TB_HEIGHT-45;if(b.indexOf("TB_iframe")!=-1){urlNoQuery=b.split("TB_");
$("#TB_iframeContent").remove();if(j.modal!="true")$("#TB_window").append("<div id='TB_title'><div id='TB_ajaxWindowTitle'>"+a+"</div><div id='TB_closeAjaxWindow'><a href='#' id='TB_closeWindowButton' title='Close'>close</a> or Esc Key</div></div><iframe frameborder='0' hspace='0' src='"+urlNoQuery[0]+"' id='TB_iframeContent' name='TB_iframeContent"+Math.round(Math.random()*1E3)+"' onload='tb_showIframe()' style='width:"+(ajaxContentW+29)+"px;height:"+(ajaxContentH+17)+"px;' > </iframe>");else{$("#TB_overlay").unbind();
$("#TB_window").append("<iframe frameborder='0' hspace='0' src='"+urlNoQuery[0]+"' id='TB_iframeContent' name='TB_iframeContent"+Math.round(Math.random()*1E3)+"' onload='tb_showIframe()' style='width:"+(ajaxContentW+29)+"px;height:"+(ajaxContentH+17)+"px;'> </iframe>")}}else if($("#TB_window").css("display")!="block")if(j.modal!="true")$("#TB_window").append("<div id='TB_title'><div id='TB_ajaxWindowTitle'>"+a+"</div><div id='TB_closeAjaxWindow'><a href='#' id='TB_closeWindowButton'>close</a> or Esc Key</div></div><div id='TB_ajaxContent' style='width:"+
ajaxContentW+"px;height:"+ajaxContentH+"px'></div>");else{$("#TB_overlay").unbind();$("#TB_window").append("<div id='TB_ajaxContent' class='TB_modal' style='width:"+ajaxContentW+"px;height:"+ajaxContentH+"px;'></div>")}else{$("#TB_ajaxContent")[0].style.width=ajaxContentW+"px";$("#TB_ajaxContent")[0].style.height=ajaxContentH+"px";$("#TB_ajaxContent")[0].scrollTop=0;$("#TB_ajaxWindowTitle").html(a)}$(".TB_closeWindowButton").click(tb_remove);if(b.indexOf("TB_inline")!=-1){$("#TB_ajaxContent").append($("#"+
j.inlineId).children());$("#TB_window").unload(function(){$("#"+j.inlineId).append($("#TB_ajaxContent").children())});tb_position();$("#TB_load").remove();$("#TB_window").css({display:"block"})}else if(b.indexOf("TB_iframe")!=-1){tb_position();if($.browser.safari){$("#TB_load").remove();$("#TB_window").css({display:"block"})}}else{var n=b.indexOf("TB_cache")!=-1;if(n&&TB_ajaxCache[b]){$("#TB_ajaxContent").html(TB_ajaxCache[b]);tb_position();$("#TB_load").remove();$("#TB_window").css({display:"block"})}else $("#TB_ajaxContent").load(b,
function(){tb_position();$("#TB_load").remove();$("#TB_window").css({display:"block"});if(n)tb_ajaxCache[b]=$("#TB_ajaxContent").html()})}}TB_PAGESIZE=tb_getPageSize();$(window).resize(tb_resize);document.onkeyup=function(d){keycode=d==null?event.keyCode:d.which;keycode==27&&tb_remove()}}catch(p){alert(p)}}function tb_showIframe(){$("#TB_load").remove();$("#TB_window").css({display:"block"})}
function tb_remove(){$("#TB_imageOff").unbind("click");$(".TB_closeWindowButton").unbind("click");$("#TB_window").fadeOut("slow",function(){$("#TB_window,#TB_overlay,#TB_HideSelect").trigger("unload").unbind().remove()});$("#TB_load").remove();if(typeof document.body.style.maxHeight=="undefined"){$("body","html").css({height:"auto",width:"auto"});$("html").css("overflow","")}document.onkeydown="";document.onkeyup="";return false}
function tb_position(){$("#TB_window").css({marginLeft:"-"+parseInt(TB_WIDTH/2,10)+"px",width:TB_WIDTH+"px"});jQuery.browser.msie&&jQuery.browser.version<7||$("#TB_window").css({marginTop:"-"+parseInt(TB_HEIGHT/2,10)+"px"})}function tb_parseQuery(a){var b={};if(!a)return b;if(a.indexOf("?")!=-1)a=a.substring(a.indexOf("?")+1);a=a.split(/[;&]/);for(var c=0;c<a.length;c++){var e=a[c].split("=");if(!(!e||e.length!=2)){var h=unescape(e[0]);e=unescape(e[1]);e=e.replace(/\+/g," ");b[h]=e}}return b}
function tb_getPageSize(){var a=document.documentElement;return arrayPageSize=[window.innerWidth||self.innerWidth||a&&a.clientWidth||document.body.clientWidth,window.innerHeight||self.innerHeight||a&&a.clientHeight||document.body.clientHeight]}function tb_detectMacXFF(){var a=navigator.userAgent.toLowerCase();if(a.indexOf("mac")!=-1&&a.indexOf("firefox")!=-1)return true}
function tb_calculateSize(a,b){a=a.toString();if(a.substring(a.length-1)=="%"){a=a.substring(0,a.length-1);var c=tb_getPageSize();return c[b]*a/100-16}else if(a<0){c=tb_getPageSize();return c[b]+a*1-16}else return a*1+(b==1?40:30)}
function tb_resize(){TB_NEW_PAGESIZE=tb_getPageSize();TB_WIDTH=tb_calculateSize(TB_WIDTH_PARAM,0);TB_HEIGHT=tb_calculateSize(TB_HEIGHT_PARAM,1);ajaxContentW=TB_WIDTH-30;ajaxContentH=TB_HEIGHT-45;if(!(TB_NEW_PAGESIZE[0]==TB_PAGESIZE[0]&&TB_NEW_PAGESIZE[1]==TB_PAGESIZE[1]))if(TB_NEW_PAGESIZE[0]==TB_PAGESIZE[0]&&TB_NEW_PAGESIZE[1]==TB_PAGESIZE[1]+1)TB_PAGESIZE=TB_NEW_PAGESIZE;else{TB_PAGESIZE=TB_NEW_PAGESIZE;$("#TB_iframeContent").css({width:ajaxContentW+29+"px",height:ajaxContentH+17+"px"});$("#TB_ajaxContent").css({width:ajaxContentW+
"px",height:ajaxContentH+"px"});tb_position()}};
